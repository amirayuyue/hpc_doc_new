"use strict";(self.webpackChunkhpc_doc_new=self.webpackChunkhpc_doc_new||[]).push([[845],{6531:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var o=t(4848),a=t(8453);const i={title:"Running Matlab",sidebar_position:1},s=void 0,r={id:"running-jobs/running_matlab",title:"Running Matlab",description:"Running Matlab on the clusters",source:"@site/docs/running-jobs/running_matlab.md",sourceDirName:"running-jobs",slug:"/running-jobs/running_matlab",permalink:"/hpc_doc_new/docs/running-jobs/running_matlab",draft:!1,unlisted:!1,editUrl:"https://github.com/amirayuyue/hpc_doc_new/docs/running-jobs/running_matlab.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Running Matlab",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Running Jupyter on Pinnacles",permalink:"/hpc_doc_new/docs/running-jobs/run_jupyter"},next:{title:"Tutorial - Extras",permalink:"/hpc_doc_new/docs/category/tutorial---extras"}},l={},c=[{value:"Running Matlab on the clusters",id:"running-matlab-on-the-clusters",level:2},{value:"Running Matlab interactively",id:"running-matlab-interactively",level:3},{value:"Running interacive session on a compute node",id:"running-interacive-session-on-a-compute-node",level:3},{value:"Running Matlab jobs",id:"running-matlab-jobs",level:3}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,a.R)(),...n.components},{Details:t}=e;return t||function(n,e){throw new Error("Expected "+(e?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h2,{id:"running-matlab-on-the-clusters",children:"Running Matlab on the clusters"}),"\n",(0,o.jsx)(e.p,{children:"After logging into the clusters, users can check and load Matlab versions currently available by running the following code. For more information on modules, check (BRING BACK MODULES PAGE)."}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"# check what matlab modules are available for use\nmodule avail\n\n# run one of the following to load matlab module into your session\nmodule load matlab/<version>    # replace <version> with the one you want to use\n"})}),"\n",(0,o.jsx)(e.h3,{id:"running-matlab-interactively",children:"Running Matlab interactively"}),"\n",(0,o.jsx)(e.admonition,{type:"warning",children:(0,o.jsx)(e.p,{children:"Do not run computationally intensive Matlab session on login node."})}),"\n",(0,o.jsx)(e.p,{children:"Users can start an interactive command line session of Matlab using"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"matlab -nodisplay -nosplash\n"})}),"\n",(0,o.jsxs)(e.p,{children:["To exit an interactive Matlab session, enter ",(0,o.jsx)(e.code,{children:"quit"})," or its equivalent ",(0,o.jsx)(e.code,{children:"exit"}),", which will take users back to bash command prompt. (Check ",(0,o.jsx)(e.a,{href:"https://www.mathworks.com/help/matlab/ref/quit.html",children:"terminate Matlab"})," session)"]}),"\n",(0,o.jsx)(e.h3,{id:"running-interacive-session-on-a-compute-node",children:"Running interacive session on a compute node"}),"\n",(0,o.jsxs)(e.p,{children:["User can also request compute node resource for running interactive jobs, the example command below is asking for 1 core from 1 node using ",(0,o.jsx)(e.code,{children:"test"})," partition for 15 mins."]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"salloc --partition=test --nodes=1 --ntasks-per-node=1 --time=00:15:00\n"})}),"\n",(0,o.jsxs)(e.p,{children:["After running the above command, ",(0,o.jsx)(e.code,{children:"SLURM"})," will allocate a suitable resource for you with a JobID. For example:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"salloc: Granted job allocation 2423487\nsalloc: Waiting for resource configuration\nsalloc: Nodes mrcd114 are ready for job\n"})}),"\n",(0,o.jsx)(e.p,{children:"Then user can use the following command to go to the allocated node with the assigned JobID."}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"srun --jobid=2423487 --pty /bin/bash\n"})}),"\n",(0,o.jsx)(e.p,{children:"After log into the node, user can do the same command mentioned above to run Matlab interactively"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"module load matlab/<version>\nmatlab -nodisplay -nosplash\n"})}),"\n",(0,o.jsxs)(e.p,{children:["To exit the allocated node, type ",(0,o.jsx)(e.code,{children:"exit"})," , and then it lead you back to the login node, type ",(0,o.jsx)(e.code,{children:"exit"})," again, will exit the job."]}),"\n",(0,o.jsx)(e.h3,{id:"running-matlab-jobs",children:"Running Matlab jobs"}),"\n",(0,o.jsxs)(e.p,{children:["Users can also run their Matlab script as a job on MERCED. Here is the ",(0,o.jsx)(e.code,{children:"SLURM"})," submission file template for running various Matlab commands as jobs."]}),"\n",(0,o.jsxs)(t,{children:[(0,o.jsx)("summary",{children:" Example Job Script for running Matlab "}),(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"#! /bin/bash\n\n#SBATCH --nodes=1\n#SBATCH --ntasks=10    # users could ask a max of 20 or 24 cores per node depending on MERCED hardware configuration\n#SBATCH -p test \n#SBATCH -M merced #This line is needed if running on Merced Cluster\n#SBATCH --mem=0  #This will use entire node memory\n#SBATCH --time=0-00:15:00     # 15 minutes\n#SBATCH --output=regular.stdout\n#SBATCH --job-name=test\n#SBATCH --export=ALL\n\n\nmodule load matlab/r2021b  # OR module load matlab/matlab_2018b\n# example 1\nmatlab -nodisplay -nodesktop -nosplash -r \"ver; exit;\"\n\n# example 2\nmatlab -nodisplay -nodesktop -nosplash -r \"license('test', 'optimization_toolbox'); exit;\"\n\n# example 3\nmatlab -nodisplay -nodesktop -nosplash -logfile /path/to/test_matlab.log < test_matlab.m\n"})})]}),"\n",(0,o.jsxs)(e.p,{children:["Users can supply ",(0,o.jsx)(e.code,{children:"-h"})," parameter to matlab to review all input parameters to matlab command i.e. ",(0,o.jsx)(e.code,{children:"matlab -h"}),"."]})]})}function u(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>s,x:()=>r});var o=t(6540);const a={},i=o.createContext(a);function s(n){const e=o.useContext(i);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:s(n.components),o.createElement(i.Provider,{value:e},n.children)}}}]);